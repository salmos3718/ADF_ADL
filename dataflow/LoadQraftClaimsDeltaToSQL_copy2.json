{
	"name": "LoadQraftClaimsDeltaToSQL_copy2",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "vgadlqaqcssa01",
						"type": "LinkedServiceReference"
					},
					"name": "Claims"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "qraft_claims",
						"type": "DatasetReference"
					},
					"name": "SqlClaims"
				}
			],
			"transformations": [
				{
					"name": "RemoveBrokenRow"
				},
				{
					"name": "RetypeInteger"
				}
			],
			"script": "source(output(\n\t\tWIS_CLAIM_JOB_RECID as string,\n\t\tWIS_CLAIM_ID as string,\n\t\tWIS_REP_ID as string,\n\t\tWIS_PRODUCT_ID as string,\n\t\tWIS_SWV_RECID as integer,\n\t\tPRODUCT_ID as string,\n\t\tREPAIR_ID as string,\n\t\tCLAIM_JOB_ID as string,\n\t\tCLAIMING_COMPANY_CD as integer,\n\t\tCLAIMING_COMPANY_DESC as string,\n\t\tBA as string,\n\t\tREP_IMP as string,\n\t\tREP_IMP_NAME as string,\n\t\tREP_DEALER as string,\n\t\tREP_DEALER_SIGA as string,\n\t\tREP_DEALER_NAME as string,\n\t\tREP_MAIN_DEALER as string,\n\t\tREF_NO as string,\n\t\tJOB_NO as string,\n\t\tREP_DIVISION as string,\n\t\tREP_SUB_DIVISION as string,\n\t\tREP_REGION as string,\n\t\tREP_STATE as string,\n\t\tREP_COUNTRY_REGION as string,\n\t\tSERVICE_DEALER_CITY as string,\n\t\tREP_CONTINENT as string,\n\t\tREP_REGION_GEO as string,\n\t\tREP_CNTRY as string,\n\t\tREP_CNTRY_ISO_2 as string,\n\t\tREP_CNTRY_NAME as string,\n\t\tREP_BA_ORGAN as string,\n\t\tREP_SALES_AREA as string,\n\t\tREP_HUB as string,\n\t\tREP_REGION_ORGAN as string,\n\t\tCLAIM_PROC_ID as string,\n\t\tCLAIM_HANDLER as string,\n\t\tRETURN_CLAIM_HANDLER as string,\n\t\tDEF_1 as string,\n\t\tDEF_1_DESC as string,\n\t\tDEF_CD as string,\n\t\tDEF_CD_DESC as string,\n\t\tFGRP1 as string,\n\t\tTREAD_GRP as string,\n\t\tFGRP1_DESC as string,\n\t\tFGRP2 as string,\n\t\tFGRP2_DESC as string,\n\t\tFGRP3 as string,\n\t\tFGRP3_DESC as string,\n\t\tFGRP4 as string,\n\t\tFGRP4_DESC as string,\n\t\tFGRP_KOLA as string,\n\t\tBUSINESS_UNIT as string,\n\t\tDES_AREA as string,\n\t\tPRIMARY_SYSTEM as string,\n\t\tDESIGN_RESP as string,\n\t\tDESIGN_LOC as string,\n\t\tVMT as string,\n\t\tSCT as string,\n\t\tCRITICALITY as string,\n\t\tPART_PREFIX_ID as string,\n\t\tPART_NO as string,\n\t\tPART_NAME as string,\n\t\tPART_NO_NEW as string,\n\t\tPART_NO_Q as string,\n\t\tPART_NO_NEW_Q as string,\n\t\tPART_CD as string,\n\t\tPART_NOTE_QJ as string,\n\t\tPART_AGE as decimal(10,0),\n\t\tPART_MILEAGE as integer,\n\t\tSERIAL_NO as string,\n\t\tSERIAL_NO_VDA as string,\n\t\tVEH_AGE_CLAIM as integer,\n\t\tMILEAGE_KM_CLAIM as integer,\n\t\tMILEAGE_MILES_CLAIM as integer,\n\t\tMAIN_OP as string,\n\t\tMAIN_OP_DESC as string,\n\t\tVST as string,\n\t\tUSED_TIME as string,\n\t\tTOT_USED_TIME as string,\n\t\tCLAIM_EVAL as string,\n\t\tSTATUS as string,\n\t\tFOLLOW_UP_CD as string,\n\t\tAGREE_NO as string,\n\t\tCOV_ID as string,\n\t\tCAMP_TYPE as string,\n\t\tREASON_CODE as string,\n\t\tCAMP_STATUS as string,\n\t\tUSER as string,\n\t\tSUPPL_NO as string,\n\t\tSUPPL_NAME as string,\n\t\tSWR_HANDLER as string,\n\t\tSUPPL_PRICE as string,\n\t\tCUR_LOCAL as string,\n\t\tTOT_PAYMENT_REF as string,\n\t\tLABOR_PAYMENT_LOCAL as string,\n\t\tMTR_PAYMENT_LOCAL as string,\n\t\tOTHER_PAYMENT_LOCAL as string,\n\t\tTOT_PAYMENT_LOCAL as string,\n\t\tLABOR_PAYMENT_SEK as double,\n\t\tMTR_PAYMENT_SEK as double,\n\t\tOTHER_PAYMENT_SEK as double,\n\t\tTOT_PAYMENT_SEK as double,\n\t\tTOT_LABOR_PAYMENT_LOCAL as double,\n\t\tTOT_MTR_PAYMENT_LOCAL as double,\n\t\tTOT_OTHER_PAYMENT_LOCAL as double,\n\t\tTOT_TRAVEL_PAYMENT_LOCAL as double,\n\t\tTOT_CLAIM_PAYMENT_LOCAL as double,\n\t\tTOT_LABOR_PAYMENT_SEK as double,\n\t\tTOT_MTR_PAYMENT_SEK as double,\n\t\tTOT_OTHER_PAYMENT_SEK as double,\n\t\tTOT_TRAVEL_PAYMENT_SEK as double,\n\t\tTOT_CLAIM_PAYMENT_SEK as double,\n\t\tTOT_LABOR_PAYMENT_EUR as double,\n\t\tTOT_MTR_PAYMENT_EUR as double,\n\t\tTOT_OTHER_PAYMENT_EUR as double,\n\t\tTOT_TRAVEL_PAYMENT_EUR as double,\n\t\tTOT_CLAIM_PAYMENT_EUR as double,\n\t\tTOT_LABOR_PAYMENT_USD as double,\n\t\tTOT_MTR_PAYMENT_USD as double,\n\t\tTOT_OTHER_PAYMENT_USD as double,\n\t\tTOT_TRAVEL_PAYMENT_USD as double,\n\t\tTOT_CLAIM_PAYMENT_USD as double,\n\t\tTOT_LABOR_PAYMENT_GBP as double,\n\t\tTOT_MTR_PAYMENT_GBP as double,\n\t\tTOT_OTHER_PAYMENT_GBP as double,\n\t\tTOT_TRAVEL_PAYMENT_GBP as double,\n\t\tTOT_CLAIM_PAYMENT_GBP as double,\n\t\tTOT_LABOR_PAYMENT_BRL as double,\n\t\tTOT_MTR_PAYMENT_BRL as double,\n\t\tTOT_OTHER_PAYMENT_BRL as double,\n\t\tTOT_TRAVEL_PAYMENT_BRL as double,\n\t\tTOT_CLAIM_PAYMENT_BRL as double,\n\t\tDEB_CD as string,\n\t\tDEB_CD_RT as string,\n\t\tDEB_CD_DESC as string,\n\t\tCLAIM_CATEGORY as string,\n\t\tTYPE_OF_CONCERN as string,\n\t\tTYPE_OF_CLAIM as string,\n\t\tWARRANTY_TYPE as string,\n\t\tCLAIM_JOB_STATUS as string,\n\t\tPAY_CD as string,\n\t\tCRED_FLAG as string,\n\t\tCLAIM_STATUS_DETAIL as string,\n\t\tREP_DATE as string,\n\t\tREP_MON as string,\n\t\tCLAIM_REG_DATE as string,\n\t\tFIRST_RELEASED_DATE as string,\n\t\tLAST_RELEASED_DATE as string,\n\t\tREADY_FOR_CREDITING_DATE as string,\n\t\tCRED_DATE as string,\n\t\tCRED_YEAR as string,\n\t\tCRED_MON as string,\n\t\tTRM_DATE_TIME as string,\n\t\tTRM_DATE as string,\n\t\tSUBMISSION_TIME as string,\n\t\tPROCESSING_TIME as string,\n\t\tCRED_NOTE as string,\n\t\tNO_OF_CLAIM_JOBS as string,\n\t\tNO_OF_UNPAID_CLAIMS as string,\n\t\tUP_STOP as string,\n\t\tUP_STOP_NO as string,\n\t\tBREAKDOWN as string,\n\t\tBREAKDOWN_NO as string,\n\t\tNO_OF_REPS as string,\n\t\tCOM_FLAG as string,\n\t\tFIRST_FAILURE_FLAG as string,\n\t\tCLAIM_HANDLING_DECISION as string,\n\t\tNO_VEHICLE as string,\n\t\tCLAIM_BRAND as string,\n\t\tSOURCE_CD as string,\n\t\tFAILURE_CD_5_DIGITS as string,\n\t\tFAILURE_CD_7_DIGITS as string,\n\t\tFAILURE_CD_8_DIGITS as string,\n\t\tFAILURE_CD_10_DIGITS as string,\n\t\tFIRST_FAILURE_TYPE as string,\n\t\tVMRS_SYS_LVL_CD as string,\n\t\tVMRS_ASSEMB_LVL_CD as string,\n\t\tVMRS_COMP_LVL_CD as string,\n\t\tCASE_NO as string,\n\t\tCASE_NO_SOURCE as string,\n\t\tFAILURE_CD_CODIF_TYPE as string,\n\t\tAFE_NO as string,\n\t\tTSA_REP_SERVICE as string,\n\t\tOP_HOURS_CLAIM as string,\n\t\tREP_ORDER_NO as string,\n\t\tSECONDARY_SETTLEMENT_CD as string,\n\t\tCOST_ADJUSTMENT_FACTOR as string,\n\t\tS_NOTES_ID as string,\n\t\tPARTS_FITTED_DATE as string,\n\t\tINSPECTOR_REPORT_USED as string,\n\t\tRETURN_CD_COUNT as string,\n\t\tRETURN_COUNT as string,\n\t\tFIRST_RETURN_DATE as string,\n\t\tLAST_RETURN_DATE as string,\n\t\tCUR_DATE as string,\n\t\tCLAIM_CUST_NO as string,\n\t\tCLAIM_CUST_NAME as string,\n\t\tSOURCE as string,\n\t\tLEGACY_PROCESSED_DTTM as string,\n\t\tPROCESSED_DTTM as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinferDriftedColumnTypes: true,\n\tignoreNoFilesFound: false,\n\tformat: 'delta',\n\tfileSystem: 'qraft',\n\tfolderPath: 'Qraft/FullDump_final/CLAIMS',\n\tdateFormats: ['yyyy-MM-dd'],\n\ttimestampFormats: ['yyyy-MM-dd\\'T\\'HH:mm:ss.SSS\\'Z\\'','yyyy-MM-dd\\'T\\'HH:mm:ss'],\n\tpreferredIntegralType: 'short',\n\tpreferredFractionalType: 'float') ~> Claims\nClaims filter(!(trim(WIS_CLAIM_ID) <=> 'UCHP1')) ~> RemoveBrokenRow\nRemoveBrokenRow derive(WIS_CLAIM_ID = toInteger(WIS_CLAIM_ID),\n\t\tWIS_CLAIM_JOB_RECID = toInteger(WIS_CLAIM_JOB_RECID)) ~> RetypeInteger\nRetypeInteger sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\trecreate:true,\n\tformat: 'table',\n\tstagingSchemaName: 'temp',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> SqlClaims"
		}
	}
}